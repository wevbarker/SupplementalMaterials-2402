(*=================*)
(*  CarloTheories  *)
(*=================*)

Section@"Carlo's list of theories";

DeparameterisationRules={
xAct`PSALTer`MetricAffineGravity`C11-xAct`PSALTer`MetricAffineGravity`C12-4*xAct`PSALTer`MetricAffineGravity`C14+2*xAct`PSALTer`MetricAffineGravity`C7-2*xAct`PSALTer`MetricAffineGravity`C8,
xAct`PSALTer`MetricAffineGravity`C11-xAct`PSALTer`MetricAffineGravity`C12-32*xAct`PSALTer`MetricAffineGravity`C13+4*xAct`PSALTer`MetricAffineGravity`C15+2*xAct`PSALTer`MetricAffineGravity`C7-2*xAct`PSALTer`MetricAffineGravity`C8,
xAct`PSALTer`MetricAffineGravity`C11-xAct`PSALTer`MetricAffineGravity`C12-4*xAct`PSALTer`MetricAffineGravity`C14+2*xAct`PSALTer`MetricAffineGravity`C7-2*xAct`PSALTer`MetricAffineGravity`C8,
xAct`PSALTer`MetricAffineGravity`C10-2*xAct`PSALTer`MetricAffineGravity`C14+2*xAct`PSALTer`MetricAffineGravity`C15+xAct`PSALTer`MetricAffineGravity`C7-xAct`PSALTer`MetricAffineGravity`C8-xAct`PSALTer`MetricAffineGravity`C9,
xAct`PSALTer`MetricAffineGravity`C10-16*xAct`PSALTer`MetricAffineGravity`C13+4*xAct`PSALTer`MetricAffineGravity`C15+xAct`PSALTer`MetricAffineGravity`C7-xAct`PSALTer`MetricAffineGravity`C8-xAct`PSALTer`MetricAffineGravity`C9,
xAct`PSALTer`MetricAffineGravity`C10+16*xAct`PSALTer`MetricAffineGravity`C13-4*xAct`PSALTer`MetricAffineGravity`C14+xAct`PSALTer`MetricAffineGravity`C7-xAct`PSALTer`MetricAffineGravity`C8-xAct`PSALTer`MetricAffineGravity`C9,
xAct`PSALTer`MetricAffineGravity`C10-2*xAct`PSALTer`MetricAffineGravity`C14+2*xAct`PSALTer`MetricAffineGravity`C15+xAct`PSALTer`MetricAffineGravity`C7-xAct`PSALTer`MetricAffineGravity`C8-xAct`PSALTer`MetricAffineGravity`C9,
xAct`PSALTer`MetricAffineGravity`C10-16*xAct`PSALTer`MetricAffineGravity`C13+4*xAct`PSALTer`MetricAffineGravity`C15+xAct`PSALTer`MetricAffineGravity`C7-xAct`PSALTer`MetricAffineGravity`C8-xAct`PSALTer`MetricAffineGravity`C9,
xAct`PSALTer`MetricAffineGravity`C10+16*xAct`PSALTer`MetricAffineGravity`C13-4*xAct`PSALTer`MetricAffineGravity`C14+xAct`PSALTer`MetricAffineGravity`C7-xAct`PSALTer`MetricAffineGravity`C8-xAct`PSALTer`MetricAffineGravity`C9,
2*xAct`PSALTer`MetricAffineGravity`C10-xAct`PSALTer`MetricAffineGravity`C11+xAct`PSALTer`MetricAffineGravity`C12+4*xAct`PSALTer`MetricAffineGravity`C15-2*xAct`PSALTer`MetricAffineGravity`C9,
xAct`PSALTer`MetricAffineGravity`C11-xAct`PSALTer`MetricAffineGravity`C12-4*xAct`PSALTer`MetricAffineGravity`C14+2*xAct`PSALTer`MetricAffineGravity`C7-2*xAct`PSALTer`MetricAffineGravity`C8,
2*xAct`PSALTer`MetricAffineGravity`C10-xAct`PSALTer`MetricAffineGravity`C11+xAct`PSALTer`MetricAffineGravity`C12+4*xAct`PSALTer`MetricAffineGravity`C15-2*xAct`PSALTer`MetricAffineGravity`C9,
2*xAct`PSALTer`MetricAffineGravity`C10-xAct`PSALTer`MetricAffineGravity`C11+xAct`PSALTer`MetricAffineGravity`C12+4*xAct`PSALTer`MetricAffineGravity`C15-2*xAct`PSALTer`MetricAffineGravity`C9,
xAct`PSALTer`MetricAffineGravity`C11-xAct`PSALTer`MetricAffineGravity`C12-4*xAct`PSALTer`MetricAffineGravity`C14+2*xAct`PSALTer`MetricAffineGravity`C7-2*xAct`PSALTer`MetricAffineGravity`C8,
2*xAct`PSALTer`MetricAffineGravity`C10-xAct`PSALTer`MetricAffineGravity`C11+xAct`PSALTer`MetricAffineGravity`C12+4*xAct`PSALTer`MetricAffineGravity`C15-2*xAct`PSALTer`MetricAffineGravity`C9,
2*xAct`PSALTer`MetricAffineGravity`C10-xAct`PSALTer`MetricAffineGravity`C11+xAct`PSALTer`MetricAffineGravity`C12+4*xAct`PSALTer`MetricAffineGravity`C15-2*xAct`PSALTer`MetricAffineGravity`C9,
xAct`PSALTer`MetricAffineGravity`C11-xAct`PSALTer`MetricAffineGravity`C12-32*xAct`PSALTer`MetricAffineGravity`C13+4*xAct`PSALTer`MetricAffineGravity`C15+2*xAct`PSALTer`MetricAffineGravity`C7-2*xAct`PSALTer`MetricAffineGravity`C8,
2*xAct`PSALTer`MetricAffineGravity`C10-xAct`PSALTer`MetricAffineGravity`C11+xAct`PSALTer`MetricAffineGravity`C12+32*xAct`PSALTer`MetricAffineGravity`C13-4*xAct`PSALTer`MetricAffineGravity`C14-2*xAct`PSALTer`MetricAffineGravity`C9,
2*xAct`PSALTer`MetricAffineGravity`C10-xAct`PSALTer`MetricAffineGravity`C11+xAct`PSALTer`MetricAffineGravity`C12+32*xAct`PSALTer`MetricAffineGravity`C13-4*xAct`PSALTer`MetricAffineGravity`C14-2*xAct`PSALTer`MetricAffineGravity`C9,
xAct`PSALTer`MetricAffineGravity`C11-xAct`PSALTer`MetricAffineGravity`C12-4*xAct`PSALTer`MetricAffineGravity`C14+2*xAct`PSALTer`MetricAffineGravity`C7-2*xAct`PSALTer`MetricAffineGravity`C8
};

DeparameterisationRules=(First@Solve[#==0])&/@DeparameterisationRules;

CarloSolutions={
	{xAct`PSALTer`MetricAffineGravity`C10->xAct`PSALTer`MetricAffineGravity`C11-xAct`PSALTer`MetricAffineGravity`C12-2xAct`PSALTer`MetricAffineGravity`C14-2xAct`PSALTer`MetricAffineGravity`C15+xAct`PSALTer`MetricAffineGravity`C7-xAct`PSALTer`MetricAffineGravity`C8+xAct`PSALTer`MetricAffineGravity`C9,
	xAct`PSALTer`MetricAffineGravity`C13->(xAct`PSALTer`MetricAffineGravity`C14+xAct`PSALTer`MetricAffineGravity`C15)/8},
	{xAct`PSALTer`MetricAffineGravity`C10->xAct`PSALTer`MetricAffineGravity`C11-xAct`PSALTer`MetricAffineGravity`C12-16xAct`PSALTer`MetricAffineGravity`C13+xAct`PSALTer`MetricAffineGravity`C7-xAct`PSALTer`MetricAffineGravity`C8+xAct`PSALTer`MetricAffineGravity`C9,
	xAct`PSALTer`MetricAffineGravity`C14->8xAct`PSALTer`MetricAffineGravity`C13-xAct`PSALTer`MetricAffineGravity`C15},
	{xAct`PSALTer`MetricAffineGravity`C10->xAct`PSALTer`MetricAffineGravity`C11-xAct`PSALTer`MetricAffineGravity`C12-16xAct`PSALTer`MetricAffineGravity`C13+xAct`PSALTer`MetricAffineGravity`C7-xAct`PSALTer`MetricAffineGravity`C8+xAct`PSALTer`MetricAffineGravity`C9,
	xAct`PSALTer`MetricAffineGravity`C15->8xAct`PSALTer`MetricAffineGravity`C13-xAct`PSALTer`MetricAffineGravity`C14},
	{xAct`PSALTer`MetricAffineGravity`C11->xAct`PSALTer`MetricAffineGravity`C10+xAct`PSALTer`MetricAffineGravity`C12+2xAct`PSALTer`MetricAffineGravity`C14+2xAct`PSALTer`MetricAffineGravity`C15-xAct`PSALTer`MetricAffineGravity`C7+xAct`PSALTer`MetricAffineGravity`C8-xAct`PSALTer`MetricAffineGravity`C9,
	xAct`PSALTer`MetricAffineGravity`C13->(xAct`PSALTer`MetricAffineGravity`C14+xAct`PSALTer`MetricAffineGravity`C15)/8},
	{xAct`PSALTer`MetricAffineGravity`C11->xAct`PSALTer`MetricAffineGravity`C10+xAct`PSALTer`MetricAffineGravity`C12+16xAct`PSALTer`MetricAffineGravity`C13-xAct`PSALTer`MetricAffineGravity`C7+xAct`PSALTer`MetricAffineGravity`C8-xAct`PSALTer`MetricAffineGravity`C9,
	xAct`PSALTer`MetricAffineGravity`C14->8xAct`PSALTer`MetricAffineGravity`C13-xAct`PSALTer`MetricAffineGravity`C15},
	{xAct`PSALTer`MetricAffineGravity`C11->xAct`PSALTer`MetricAffineGravity`C10+xAct`PSALTer`MetricAffineGravity`C12+16xAct`PSALTer`MetricAffineGravity`C13-xAct`PSALTer`MetricAffineGravity`C7+xAct`PSALTer`MetricAffineGravity`C8-xAct`PSALTer`MetricAffineGravity`C9,
	xAct`PSALTer`MetricAffineGravity`C15->8xAct`PSALTer`MetricAffineGravity`C13-xAct`PSALTer`MetricAffineGravity`C14},
	{xAct`PSALTer`MetricAffineGravity`C12->-xAct`PSALTer`MetricAffineGravity`C10+xAct`PSALTer`MetricAffineGravity`C11-2xAct`PSALTer`MetricAffineGravity`C14-2xAct`PSALTer`MetricAffineGravity`C15+xAct`PSALTer`MetricAffineGravity`C7-xAct`PSALTer`MetricAffineGravity`C8+xAct`PSALTer`MetricAffineGravity`C9,
	xAct`PSALTer`MetricAffineGravity`C13->(xAct`PSALTer`MetricAffineGravity`C14+xAct`PSALTer`MetricAffineGravity`C15)/8},
	{xAct`PSALTer`MetricAffineGravity`C12->-xAct`PSALTer`MetricAffineGravity`C10+xAct`PSALTer`MetricAffineGravity`C11-16xAct`PSALTer`MetricAffineGravity`C13+xAct`PSALTer`MetricAffineGravity`C7-xAct`PSALTer`MetricAffineGravity`C8+xAct`PSALTer`MetricAffineGravity`C9,
	xAct`PSALTer`MetricAffineGravity`C14->8xAct`PSALTer`MetricAffineGravity`C13-xAct`PSALTer`MetricAffineGravity`C15},
	{xAct`PSALTer`MetricAffineGravity`C12->-xAct`PSALTer`MetricAffineGravity`C10+xAct`PSALTer`MetricAffineGravity`C11-16xAct`PSALTer`MetricAffineGravity`C13+xAct`PSALTer`MetricAffineGravity`C7-xAct`PSALTer`MetricAffineGravity`C8+xAct`PSALTer`MetricAffineGravity`C9,
	xAct`PSALTer`MetricAffineGravity`C15->8xAct`PSALTer`MetricAffineGravity`C13-xAct`PSALTer`MetricAffineGravity`C14},
	{xAct`PSALTer`MetricAffineGravity`C13->1/16(-xAct`PSALTer`MetricAffineGravity`C10+xAct`PSALTer`MetricAffineGravity`C11-xAct`PSALTer`MetricAffineGravity`C12+xAct`PSALTer`MetricAffineGravity`C7-xAct`PSALTer`MetricAffineGravity`C8+xAct`PSALTer`MetricAffineGravity`C9),
	xAct`PSALTer`MetricAffineGravity`C14->1/2(-xAct`PSALTer`MetricAffineGravity`C10+xAct`PSALTer`MetricAffineGravity`C11-xAct`PSALTer`MetricAffineGravity`C12-2xAct`PSALTer`MetricAffineGravity`C15+xAct`PSALTer`MetricAffineGravity`C7-xAct`PSALTer`MetricAffineGravity`C8+xAct`PSALTer`MetricAffineGravity`C9)},
	{xAct`PSALTer`MetricAffineGravity`C13->1/16(-xAct`PSALTer`MetricAffineGravity`C10+xAct`PSALTer`MetricAffineGravity`C11-xAct`PSALTer`MetricAffineGravity`C12+xAct`PSALTer`MetricAffineGravity`C7-xAct`PSALTer`MetricAffineGravity`C8+xAct`PSALTer`MetricAffineGravity`C9),
	xAct`PSALTer`MetricAffineGravity`C15->1/2(-xAct`PSALTer`MetricAffineGravity`C10+xAct`PSALTer`MetricAffineGravity`C11-xAct`PSALTer`MetricAffineGravity`C12-2xAct`PSALTer`MetricAffineGravity`C14+xAct`PSALTer`MetricAffineGravity`C7-xAct`PSALTer`MetricAffineGravity`C8+xAct`PSALTer`MetricAffineGravity`C9)},
	{xAct`PSALTer`MetricAffineGravity`C13->(xAct`PSALTer`MetricAffineGravity`C14+xAct`PSALTer`MetricAffineGravity`C15)/8,
	xAct`PSALTer`MetricAffineGravity`C7->xAct`PSALTer`MetricAffineGravity`C10-xAct`PSALTer`MetricAffineGravity`C11+xAct`PSALTer`MetricAffineGravity`C12+2xAct`PSALTer`MetricAffineGravity`C14+2xAct`PSALTer`MetricAffineGravity`C15+xAct`PSALTer`MetricAffineGravity`C8-xAct`PSALTer`MetricAffineGravity`C9},
	{xAct`PSALTer`MetricAffineGravity`C13->(xAct`PSALTer`MetricAffineGravity`C14+xAct`PSALTer`MetricAffineGravity`C15)/8,
	xAct`PSALTer`MetricAffineGravity`C8->-xAct`PSALTer`MetricAffineGravity`C10+xAct`PSALTer`MetricAffineGravity`C11-xAct`PSALTer`MetricAffineGravity`C12-2xAct`PSALTer`MetricAffineGravity`C14-2xAct`PSALTer`MetricAffineGravity`C15+xAct`PSALTer`MetricAffineGravity`C7+xAct`PSALTer`MetricAffineGravity`C9},
	{xAct`PSALTer`MetricAffineGravity`C13->(xAct`PSALTer`MetricAffineGravity`C14+xAct`PSALTer`MetricAffineGravity`C15)/8,
	xAct`PSALTer`MetricAffineGravity`C9->xAct`PSALTer`MetricAffineGravity`C10-xAct`PSALTer`MetricAffineGravity`C11+xAct`PSALTer`MetricAffineGravity`C12+2xAct`PSALTer`MetricAffineGravity`C14+2xAct`PSALTer`MetricAffineGravity`C15-xAct`PSALTer`MetricAffineGravity`C7+xAct`PSALTer`MetricAffineGravity`C8},
	{xAct`PSALTer`MetricAffineGravity`C14->8xAct`PSALTer`MetricAffineGravity`C13-xAct`PSALTer`MetricAffineGravity`C15,
	xAct`PSALTer`MetricAffineGravity`C7->xAct`PSALTer`MetricAffineGravity`C10-xAct`PSALTer`MetricAffineGravity`C11+xAct`PSALTer`MetricAffineGravity`C12+16xAct`PSALTer`MetricAffineGravity`C13+xAct`PSALTer`MetricAffineGravity`C8-xAct`PSALTer`MetricAffineGravity`C9},
	{xAct`PSALTer`MetricAffineGravity`C14->8xAct`PSALTer`MetricAffineGravity`C13-xAct`PSALTer`MetricAffineGravity`C15,
	xAct`PSALTer`MetricAffineGravity`C8->-xAct`PSALTer`MetricAffineGravity`C10+xAct`PSALTer`MetricAffineGravity`C11-xAct`PSALTer`MetricAffineGravity`C12-16xAct`PSALTer`MetricAffineGravity`C13+xAct`PSALTer`MetricAffineGravity`C7+xAct`PSALTer`MetricAffineGravity`C9},
	{xAct`PSALTer`MetricAffineGravity`C14->8xAct`PSALTer`MetricAffineGravity`C13-xAct`PSALTer`MetricAffineGravity`C15,
	xAct`PSALTer`MetricAffineGravity`C9->xAct`PSALTer`MetricAffineGravity`C10-xAct`PSALTer`MetricAffineGravity`C11+xAct`PSALTer`MetricAffineGravity`C12+16xAct`PSALTer`MetricAffineGravity`C13-xAct`PSALTer`MetricAffineGravity`C7+xAct`PSALTer`MetricAffineGravity`C8},
	{xAct`PSALTer`MetricAffineGravity`C15->8xAct`PSALTer`MetricAffineGravity`C13-xAct`PSALTer`MetricAffineGravity`C14,
	xAct`PSALTer`MetricAffineGravity`C7->xAct`PSALTer`MetricAffineGravity`C10-xAct`PSALTer`MetricAffineGravity`C11+xAct`PSALTer`MetricAffineGravity`C12+16xAct`PSALTer`MetricAffineGravity`C13+xAct`PSALTer`MetricAffineGravity`C8-xAct`PSALTer`MetricAffineGravity`C9},
	{xAct`PSALTer`MetricAffineGravity`C15->8xAct`PSALTer`MetricAffineGravity`C13-xAct`PSALTer`MetricAffineGravity`C14,
	xAct`PSALTer`MetricAffineGravity`C8->-xAct`PSALTer`MetricAffineGravity`C10+xAct`PSALTer`MetricAffineGravity`C11-xAct`PSALTer`MetricAffineGravity`C12-16xAct`PSALTer`MetricAffineGravity`C13+xAct`PSALTer`MetricAffineGravity`C7+xAct`PSALTer`MetricAffineGravity`C9},
	{xAct`PSALTer`MetricAffineGravity`C15->8xAct`PSALTer`MetricAffineGravity`C13-xAct`PSALTer`MetricAffineGravity`C14,
	xAct`PSALTer`MetricAffineGravity`C9->xAct`PSALTer`MetricAffineGravity`C10-xAct`PSALTer`MetricAffineGravity`C11+xAct`PSALTer`MetricAffineGravity`C12+16xAct`PSALTer`MetricAffineGravity`C13-xAct`PSALTer`MetricAffineGravity`C7+xAct`PSALTer`MetricAffineGravity`C8}
};

Comment@"Now we will study the batch of theories sent by Carlo.";
DisplayExpression/@CarloSolutions;
(*DisplayExpression/@DeparameterisationRules;*)

TheNonlinearLagrangian=NonlinearLagrangian/.{
	xAct`PSALTer`MetricAffineGravity`A1->0,
	xAct`PSALTer`MetricAffineGravity`A2->0,
	xAct`PSALTer`MetricAffineGravity`A3->0,
	xAct`PSALTer`MetricAffineGravity`A4->0,
	xAct`PSALTer`MetricAffineGravity`A5->0,
	xAct`PSALTer`MetricAffineGravity`A6->0,
	xAct`PSALTer`MetricAffineGravity`A7->0,
	xAct`PSALTer`MetricAffineGravity`A8->0,
	xAct`PSALTer`MetricAffineGravity`A9->0,
	xAct`PSALTer`MetricAffineGravity`A10->0,
	xAct`PSALTer`MetricAffineGravity`A11->0,
	xAct`PSALTer`MetricAffineGravity`C1->0,
	xAct`PSALTer`MetricAffineGravity`C2->0,
	xAct`PSALTer`MetricAffineGravity`C3->0,
	xAct`PSALTer`MetricAffineGravity`C4->0,
	xAct`PSALTer`MetricAffineGravity`C5->0,
	xAct`PSALTer`MetricAffineGravity`C6->0,
	xAct`PSALTer`MetricAffineGravity`C16->0};

Comment@"Here is the most general Ricci-type theory.";
DisplayExpression[TheNonlinearLagrangian,EqnLabel->"MetricAffineRicciTypeTheory"];

CaseNumber=1;

CarloTestTheory[RuleSet_,DeparameterisationRuleSet_]:=Module[{LinearLagrangian},
	LinearLagrangian=TheNonlinearLagrangian;

	Comment@"Here is a new case defined by Carlo.";
	DisplayExpression[RuleSet,EqnLabel->("RuleSet"<>ToString@CaseNumber)];
	Comment@{"But",Cref@("RuleSet"<>ToString@CaseNumber)," by itself results in a parameterised symmetry. To get rid of it, we need one further constraint which does not change the overall number of gauge generators."};	
	DisplayExpression[DeparameterisationRuleSet,EqnLabel->("DeparameterisationRuleSet"<>ToString@CaseNumber)];
	Comment@{"So by imposing",Cref@("RuleSet"<>ToString@CaseNumber)," and",Cref@("DeparameterisationRuleSet"<>ToString@CaseNumber)," on the theory in",Cref@"MetricAffineRicciTypeTheory"," we obtain the following."};
	LinearLagrangian=LinearLagrangian/.RuleSet;
	LinearLagrangian=LinearLagrangian/.DeparameterisationRuleSet;
	DisplayExpression[LinearLagrangian,EqnLabel->("CarloTheory"<>ToString@CaseNumber)];

	Comment@{"We first perform the spectral analysis of",Cref@("CarloTheory"<>ToString@CaseNumber)," in the first-order formulation (Palatini basis, in which the connection is independent of the metric)."};
	LinearLagrangian*=Measure;
	LinearLagrangian//=LineariseLagrangian;
(*
	ParticleSpectrum[LinearLagrangian,
			ClassName->"MetricAffineGravity",
			TheoryName->("CarloTheory"<>ToString@CaseNumber),	
			Method->"Hard",
			MaxLaurentDepth->1];
*)

	Comment@{"We next perform the spectral analysis of",Cref@("CarloTheory"<>ToString@CaseNumber)," in the second-order formulation (distortion basis, in which the distortion, i.e. contortion and disformation or torsion and non-metricity, are independent of the metric)."};
	LinearLagrangian=LineariseLagrangian[LinearLagrangian,Formulation->SecondOrder];
	ParticleSpectrum[LinearLagrangian,
			ClassName->"MetricAffineGravity",
			TheoryName->("CarloTheory"<>ToString@CaseNumber<>"SecondOrder"),	
			Method->"Hard",
			MaxLaurentDepth->1];

	Supercomment@{"So, the theory",Cref@("CarloTheory"<>ToString@CaseNumber)," cannot be viable."};
	CaseNumber+=1;
];

MapThread[CarloTestTheory[#1,#2]&,{CarloSolutions,DeparameterisationRules}];
